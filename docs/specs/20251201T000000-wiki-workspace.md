# Wiki Workspace and Content Flow Refactor

## Overview

Create a wiki workspace for evergreen knowledge base entries that serve as the source of truth for all distributed content. Refactor the posts workspace to reference wiki entries instead of pages.

## Motivation

The current content model has:
- **clippings**: External content you save (articles, books, recipes)
- **pages**: Content you write with a publishing workflow (Draft → Published)
- **posts**: Social media distribution across platforms

The problem: `posts` currently references `page_id`, but the relationship between pages and posts is unclear. Pages have a publishing lifecycle that doesn't match the "source of truth" concept.

The solution: Create a **wiki** workspace for permanent, evergreen reference content. Posts derive from wiki entries, creating a clear content flow:

```
wiki.entries (source of truth, permanent)
    ↓ derives
posts.* (distribution, platform-specific)
```

## Implementation Plan

### 1. Create Wiki Workspace

- [ ] Create `examples/content-hub/wiki/wiki.workspace.ts`
- [ ] Create `examples/content-hub/wiki/README.md`

**Schema:**
```typescript
schema: {
  entries: {
    id: id(),
    title: text(),
    content: text(),
    summary: text({ nullable: true }),
    tags: tags({ nullable: true }),
    created_at: date(),
    updated_at: date(),
  },
}
```

Key differences from pages:
- No `status` field (no publishing lifecycle)
- No `visibility` field (wiki entries are internal reference)
- Simpler schema focused on content

### 2. Refactor Posts Workspace

- [ ] Remove `page_id` from all post schemas
- [ ] Add `entry_id` (required) to all post schemas
- [ ] Update JSDoc comments to reflect new relationship

**Before:**
```typescript
const SHORT_FORM_VIDEO_SCHEMA = {
  id: id(),
  page_id: text(),  // References pages
  // ...
}
```

**After:**
```typescript
const SHORT_FORM_VIDEO_SCHEMA = {
  id: id(),
  entry_id: text(),  // References wiki.entries (required)
  // ...
}
```

### 3. Documentation

The wiki README should explain:
1. What wiki entries are (evergreen source of truth)
2. How they differ from pages (no publishing lifecycle)
3. The content flow to posts
4. Markdown linking between entries

## Design Decisions

1. **entry_id is required**: Every post must derive from a wiki entry. This enforces a disciplined content workflow where you think first (wiki), then distribute (posts).

2. **No additional wiki tables**: Entries can link to each other via markdown links in content. No need for a separate `entry_links` table.

3. **Wiki replaces page_id in posts**: Pages serve a different purpose (publishing workflow) and shouldn't be the source for posts.

## Review

### Changes Made

1. **Created `wiki/wiki.workspace.ts`**: New workspace with `entries` table for evergreen knowledge base content. Schema includes title, content, summary, tags, and timestamps. Uses markdown index with body field for content.

2. **Created `wiki/README.md`**: Documentation explaining:
   - What wiki entries are (evergreen source of truth)
   - Content flow diagram (wiki.entries → posts.*)
   - Comparison table: wiki vs pages
   - How entries link to each other via markdown

3. **Refactored `posts/posts.workspace.ts`**:
   - Renamed `page_id` to `entry_id` in all three schema constants
   - Updated JSDoc comments to describe the wiki → posts content flow
   - Made `entry_id` required (not nullable) to enforce disciplined workflow

### Files Changed

- `examples/content-hub/wiki/wiki.workspace.ts` (new)
- `examples/content-hub/wiki/README.md` (new)
- `examples/content-hub/posts/posts.workspace.ts` (modified)
